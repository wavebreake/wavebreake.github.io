---
layout: post
title:  "k8s概述"
date:   2022-04-15 12:00:00 +0800
categories: kubernetes
---
# 概念

## Containers

操作系统层虚拟化（英语：Operating system–level virtualization），亦称容器化（英语：Containerization），是一种虚拟化技术，这种技术将操作系统内核虚拟化，可以允许用户空间软件实例（instances）被分割成几个独立的单元，在内核中运行，而不是只有一个单一实例运行。

这个软件实例，也被称为是一个容器（containers），虚拟引擎（Virtualization engine），虚拟专用服务器（virtual private servers）或是 jails。对每个行程的拥有者与用户来说，他们使用的服务器程序，看起来就像是自己专用的。

操作系统层虚拟化之后，可以实现软件的即时迁移（Live migration），使一个软件容器中的实例，即时移动到另一个操作系统下，再重新执行起来。但是在这种技术下，软件即时迁移，只能在同样的操作系统下进行。

在类Unix操作系统中，这个技术最早起源于标准的chroot机制，再进一步演化而成。除了将软件独立化的机制之外，内核通常也提供资源管理功能，使得单一软件容器在运作时，对于其他软件容器的造成的交互影响最小化。

相对于传统的虚拟化（Virtualization），容器化的优势在于占用服务器空间少，通常几秒内即可启动。同时容器的弹性可以在资源需求增加时瞬时复制增容，在资源需求减小时释放空间以供其他用户使用。由于在同一台服务器上的容器实例共享同一个系统内核，因此在运行上不会存在实例与主机操作系统争夺RAM的问题发生，从而能够保证实例的性能。

## Kubernetes(K8s)

Kubernetes（常简称为K8s）是用于自动部署、扩展和管理“容器化（containerized）应用程序”的开源系统。该系统由Google设计并捐赠给Cloud Native Computing Foundation（今属Linux基金会）来使用。

它旨在提供“跨主机集群的自动部署、扩展以及运行应用程序容器的平台”。 它支持一系列容器工具，包括Docker等。

Kubernetes（在希腊语意为“舵手”或“驾驶员”）由Joe Beda、Brendan Burns和Craig McLuckie创立，并由其他谷歌工程师，包括Brian Grant和Tim Hockin等进行加盟创作，并由谷歌在2014年首次对外宣布 。该系统的开发和设计都深受谷歌的Borg系统的影响，其许多顶级贡献者之前也是Borg系统的开发者。在谷歌内部，Kubernetes的原始代号曾经是Seven，即星际迷航中的Borg（博格人）。Kubernetes标识中舵轮有七个轮辐就是对该项目代号的致意。

Kubernetes v1.0于2015年7月21日发布。随着v1.0版本发布，谷歌与Linux 基金会合作组建了Cloud Native Computing Foundation（CNCF）并将Kubernetes作为种子技术来提供。

Rancher Labs在其Rancher容器管理平台中包含了Kubernetes的发布版。Kubernetes也在很多其他公司的产品中被使用，例如Red Hat的OpenShift， CoreOS的Tectonic， IBM的IBM私有云产品，，精灵云的EcOS，KubeSphere，以及 VMware的PKS等等。

而现今信息界常见的缩写手法“K8s”则是将“ubernete”八个字母缩写为“8”而来。

## 云原生

云原生计算是一种软件开发方法，它利用云计算“在公共、私有和混合云等现代动态环境中构建和运行可扩展的应用程序”。 通过声明性代码部署的容器、微服务、无服务器功能和不可变基础设施等技术是这种架构风格的常见元素。

这些技术支持具有弹性、可管理和可观察的松散耦合系统。结合强大的自动化，它们使工程师能够以最少的工作频繁且可预测地进行高影响力的更改。

通常，云原生应用程序被构建为一组在 Docker 容器中运行的微服务，并且可以在 Kubernetes 中进行编排，并使用 DevOps 和 Git CI 工作流进行管理和部署（尽管有大量竞争开源支持云原生开发）。使用 Docker 容器的优势在于能够将执行所需的所有软件打包到一个可执行包中。容器在虚拟化环境中运行，将包含的应用程序与其环境隔离开来。

## 云原生计算基金会

云原生计算基金会 (CNCF) 是一个 Linux 基金会项目，成立于 2015 年，旨在帮助推进容器技术 并使科技行业围绕其发展进行调整。

它与开源容器集群管理器 Kubernetes 1.0 一起发布，它是由谷歌作为种子技术贡献给 Linux 基金会的。创始成员包括 Google、CoreOS、Mesosphere、Red Hat、Twitter、华为、英特尔、思科、IBM、Docker、Univa 和 VMware。[2][3]今天，CNCF 得到了 450 多名成员的支持。为了建立由 CNCF 管理的技术的合格代表，2016 年 8 月在多伦多举行的首届 CloudNativeDay 上宣布了一项计划。

## 理解：

和VM对比：

1. VM是硬件虚拟化，共享硬件API，操作系统之间无感知。
2. 容器是操作系统虚拟化，共享操作系统内核API，容器实例之间无感知，所有容器实例使用相同版本操作系统。

容器理念上的优势:

1. 容器镜像的管理方式比传统软件发布方式更敏捷。对于微服务理念，将一个大型服务拆分成若干小型服务，增加了总体的软件环境管理成本，容器镜像的管理方式能很大程度上解决这部分问题。
2. K8s看起来已成为事实标准，这为容器应用生态提供了良好环境。目前云服务供应商提供的服务标准并不统一，业务迁移基本上只能从应用层面进行，比如server重新部署、数据库逻辑复制等；在容器生态下，容器镜像理论上能够迁移到任何云上的K8s集群，这为业务迁移、第三方容器应用生态提供了良好环境。
3. 编排能力提供更自由的调度管理。

云容器服务：

目前云服务供应商提供多类云容器服务，比如

1. 云容器引擎服务，用户管理完整的K8s集群
2. 弹性云容器实例服务，或称serverless容器服务，用户无需管理K8s集群，按需创建容器实例
3. 容器镜像服务，global镜像仓库
4. ……

# 容器服务

## Amazon Web Service(AWS)

容器管理工具可以分为三类：注册表、编排和计算。AWS 提供的服务可为您提供一个安全的位置来存储和管理您的容器镜像、管理容器运行时间和地点的编排，以及为您的容器提供支持的灵活计算引擎。AWS 可以帮助您管理容器及其部署，因此您不必担心底层基础设施。无论您要构建什么，AWS 都能让您轻松高效地使用容器进行构建。

| 分类  | 服务                                             |                                                                  |
| --- | ---------------------------------------------- | ---------------------------------------------------------------- |
| 计算  | AWS Fargate                                    | 是一种为容器构建的无服务器计算引擎。Fargate 使您可以轻松专注于构建应用程序。                       |
|     | Amazon EC2                                     | 在虚拟机基础设施上运行容器，并完全控制配置和扩缩。                                        |
|     | AWS App Runner                                 | 是一项完全托管式服务，使开发人员能够轻松地大规模快速部署容器化 Web 应用程序和 API，而无需事先具备基础设施方面的经验。  |
| 编排  | Amazon Elastic Container Service (Amazon ECS)  | 是一项完全托管式容器编排服务，可提供最安全、可靠且可扩展的方式来运行容器化应用程序。                       |
|     | Amazon Elastic Kubernetes Service (Amazon EKS) | 是一个完全托管式 Kubernetes 服务，可提供最安全、可靠且可扩展的方式来使用 Kubernetes 运行容器化应用程序。 |
|     | Red Hat OpenShift Service on AWS (ROSA)        | 是一个完全托管式应用程序平台，具有统包 IDE、运行时、构建工具、CI/CD、服务网格等。                    |
| 注册表 | Amazon Elastic Container Registry(ECR)         | 是完全托管式容器注册表，使开发人员能够快速地轻松存储、管理和部署容器镜像。                            |

## Microsoft Azure

| 服务                        |                                 |
| ------------------------- | ------------------------------- |
| Azure Kubernetes 服务 (AKS) | 在托管 Kubernetes 上部署和缩放容器         |
| Azure Red Hat OpenShift   | 在托管 Red Hat OpenShift 上部署和缩放容器  |
| Azure 容器应用                | 使用无服务器容器构建和部署新式应用和微服务           |
| Azure Functions           | 通过端到端的开发体验执行事件驱动的无服务器代码         |
| 容器的 Web 应用                | 在 Windows 和 Linux 上运行容器化 Web 应用 |
| 容器实例                      | 启动具有虚拟机监控程序隔离的容器                |
| Service Fabric            | 部署和运行始终可用的可缩放分散式应用              |
| 容器注册表                     | 生成、存储、保护和复制容器映像和项目              |

## Google Cloud Platform(GCP)

| 服务                                        |                            |
| ----------------------------------------- | -------------------------- |
| Artifact Registry                         | 存储、管理和保护容器映像及语言包。          |
| Cloud Build                               | 用于在 Docker 容器中运行构建步骤的解决方案。 |
| Cloud Run                                 | 用于运行容器化应用的全代管式环境。          |
| Container Registry                        | 用于存储、管理和保护 Docker 映像的注册表。  |
| 容器安全性                                     | 生命周期中每个阶段的容器环境安全性。         |
| Deep Learning Containers                  | 具有各种数据科学框架、库和工具的容器。        |
| Google Kubernetes Engine (GKE)            | 用于运行容器化应用的代管式环境。           |
| Knative                                   | 用于构建 Kubernetes 原生云软件的组件。  |
| Google Cloud Marketplace 上的 Kubernetes 应用 | 具有预建部署和统一结算功能的容器化应用。       |

## 阿里云

| 服务                  |                                                                          |
| ------------------- | ------------------------------------------------------------------------ |
| 弹性容器实例              | Serverless 和容器化的弹性计算服务，无需管理底层 ECS 服务器，只需提供打包好的镜像，即可运行容器，仅为容器实际运行消耗的资源付费。 |
| 容器服务 ACK            | 提供高性能可伸缩的容器应用管理能力，支持企业级 Kubernetes 容器化应用的全生命周期管理。                        |
| 边缘容器服务              | 一款提供标准 Kubernetes 集群云端托管，支持边缘计算资源、业务快速接入、统一管理、统一运维的云原生应用平台。              |
| Serverless 容器服务 ASK | Serverless 容器服务是一款基于阿里云弹性计算基础架构，同时完全兼容 Kubernetes 生态，安全、可靠的容器产品。         |
| 服务网格 ASM            | 一个托管式的微服务应用流量统一管理平台，支持多个Kubernetes集群统一流量管理，为容器和虚拟机应用服务提供一致性的通信控制。        |
| 容器镜像服务 ACR          | 提供云原生资产的安全托管和全生命周期管理，支持多场景下镜像的高效分发，与容器服务 ACK 无缝集成，打造云原生应用一站式解决方案。        |

## 华为云

| 服务     |                                                                                                                                                                                                                                                              |
| ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 云容器引擎  | 云容器引擎（Cloud Container Engine，简称CCE）提供高度可扩展的、高性能的企业级Kubernetes集群，支持运行Docker容器，提供了Kubernetes集群管理、容器应用全生命周期管理、应用服务网格、Helm应用模板、插件管理、应用调度、监控与运维等容器全栈能力，为您提供一站式容器平台服务。借助云容器引擎，您可以在华为云上轻松部署、管理和扩展容器化应用程序。                                                           |
| 云容器实例  | 云容器实例（Cloud Container Instance，简称CCI）服务提供Serverless Container（无服务器容器）引擎，让您无需创建和管理服务器集群即可直接运行容器。通过CCI您只需要管理运行在Kubernetes上的容器化业务，无需管理集群和服务器即可在CCI上快速创建和运行容器负载，使容器应用零运维，使企业聚焦业务核心，为企业提供了Serverless化全新一代的体验和选择。                                                  |
| 容器镜像服务 | 容器镜像服务（Software Repository for Container，简称SWR），是一种支持容器镜像全生命周期管理的服务， 提供简单易用、安全可靠的镜像管理功能，帮助用户快速部署容器化服务。                                                                                                                                                       |
| 容器安全服务 | 容器安全服务（Container Guard Service，CGS）能够扫描镜像中的漏洞与配置信息，帮助企业解决传统安全软件无法感知容器环境的问题；同时提供容器进程白名单、文件只读保护和容器逃逸检测功能，有效防止容器运行时安全风险事件的发生。                                                                                                                                   |
| 智能边缘平台 | 智能边缘平台（Intelligent EdgeFabric，简称IEF）通过纳管用户的边缘节点，提供将云上应用延伸到边缘的能力，联动边缘和云端的数据，满足客户对边缘计算资源的远程管控、数据处理、分析决策、智能化的诉求，同时，在云端提供统一的设备/应用监控、日志采集等运维能力，为企业提供完整的边缘和云协同的一体化服务的边缘计算解决方案。                                                                                     |
| 多云容器平台 | 多云容器平台（Multi-Cloud Container Platform，简称MCP）是华为云基于多年容器云领域实践经验和社区先进的集群联邦技术，提供的容器多云和混合云的解决方案，为您提供跨云的多集群统一管理、应用在多集群的统一部署和流量分发，为您彻底解决多云灾备问题的同时，还可以在业务流量分担、业务与数据分离、开发与生产分离、计算与业务分离等多种场景下发挥价值。                                                                     |
| 应用服务网格 | 应用服务网格（Application Service Mesh，简称ASM）是华为云基于开源Istio推出的服务网格平台，它深度、无缝对接了华为云的企业级Kubernetes集群服务云容器引擎（Cloud Container Engine，简称CCE），在易用性、可靠性、可视化等方面进行了一系列增强，可为客户提供开箱即用的上手体验。 应用服务网格提供非侵入式的微服务治理解决方案，支持完整的生命周期管理和流量治理，兼容Kubernetes和Istio生态，其功能包括负载均衡、熔断、限流等多种治理能力。 |

## 天翼云

| 服务    |                                                                                                                                        |
| ----- | -------------------------------------------------------------------------------------------------------------------------------------- |
| 云容器引擎 | Kubernetes etcd Docker flannel Calico CoreDNS Ingress-nginx-controller Prometheus LB Nginx Keepalive Harbor bind-utils Docker-comepose |

![](https://github.com/wavebreake/imagehosting/blob/main/cce.png?raw=true)

# 容器化应用

## 研发

研发部门研究方向：容器网络 容器存储 数据库容器化 ……

## 解决方案

解决方案部门研究方向：业务系统容器化，微服务……
